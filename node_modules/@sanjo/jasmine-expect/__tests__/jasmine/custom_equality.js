var createJ$ = require('../../index').createJ$;
var createSpyEnv = require('@sanjo/jasmine-spy').createEnv;
var createExpectEnv = require('../../index').createEnv;

var j$ = createJ$();
var expectEnv = createExpectEnv(j$);
var spyEnv = createSpyEnv(j$);

var expect = expectEnv.expect;
var spyOn = spyEnv.spyOn;
var jasmine = {
  createSpy: spyEnv.createSpy,
  createSpyObj: spyEnv.createSpyObj,
  any: expectEnv.any,
  anything: expectEnv.anything,
  objectContaining: expectEnv.objectContaining,
  stringMatching: expectEnv.stringMatching,
  arrayContaining: expectEnv.arrayContaining,
  addCustomEqualityTester: expectEnv.addCustomEqualityTester,
  addMatchers: expectEnv.addMatchers,
};

// The specs were taken from the Jasmine documentation:
// Website: http://jasmine.github.io/2.4/custom_equality.html
// Raw: https://raw.githubusercontent.com/jasmine/jasmine.github.io/master/2.4/src/custom_equality.js

/**
 * ## Custom Equality Testers
 */
describe("custom equality", function() {
  /**
   * You can customize how jasmine determines if two objects are equal by defining your own custom equality testers.
   * A custom equality tester is a function that takes two arguments.
   */
  var myCustomEquality = function(first, second) {
    /**
     * If the custom equality tester knows how to compare the two items, it should return either true or false
     */

    if (typeof first == "string" && typeof second == "string") {
      return first[0] == second[1];
    }

    /**
     * Otherwise, it should return undefined, to tell jasmine's equality tester that it can't compare the items
     */
  };

  /**
   * Then you register your tester in a `beforeEach` so jasmine knows about it.
   */
  beforeEach(function() {
    jasmine.addCustomEqualityTester(myCustomEquality);
  });

  /**
   * Then when you do comparisons in a spec, custom equality testers will be checked first before the default equality logic.
   */
  it("should be custom equal", function() {
    expect("abc").toEqual("aaa");
  });

  /**
   * If your custom tester returns false, no other equality checking will be done.
   */
  it("should be custom not equal", function() {
    expect("abc").not.toEqual("abc");
  });
});
