var jRequire = require('jasmine-core/lib/jasmine-core/jasmine');

module.exports.createJ$ = function () {
  return jRequire.core(jRequire);
}

module.exports.createEnv = function (j$) {
  if (typeof j$ === 'undefined') {
    j$ = module.exports.createJ$();
  }

  var env = {
    spies: [],
    spyRegistry: new j$.SpyRegistry({currentSpies: function() {
      return env.spies;
    }}),
    spyOn: function() {
      return env.spyRegistry.spyOn.apply(env.spyRegistry, arguments);
    },
    clearSpies: function () {
      env.spyRegistry.clearSpies();
      env.spies = [];
    },
    createSpy: function (name, originalFn) {
      return j$.createSpy(name, originalFn);
    },
    isSpy: function (putativeSpy) {
      return j$.isSpy(putativeSpy);
    },
    createSpyObj: function (baseName, methodNames) {
      return j$.createSpyObj(baseName, methodNames);
    }
  };

  return env;
};
